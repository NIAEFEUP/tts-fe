{"version":3,"sources":["../../../../../packages/vite/src/utils/e2e-web-server-info-utils.ts"],"sourcesContent":["import { type Tree, readNxJson } from '@nx/devkit';\nimport { getE2EWebServerInfo } from '@nx/devkit/src/generators/e2e-web-server-info-utils';\n\nexport async function getViteE2EWebServerInfo(\n  tree: Tree,\n  projectName: string,\n  configFilePath: string,\n  isPluginBeingAdded: boolean,\n  e2ePortOverride?: number\n) {\n  const nxJson = readNxJson(tree);\n  let e2ePort = e2ePortOverride ?? 4200;\n\n  if (\n    (nxJson.targetDefaults?.['dev'] &&\n      nxJson.targetDefaults?.['dev'].options?.port) ||\n    (nxJson.targetDefaults?.['serve'] &&\n      nxJson.targetDefaults?.['serve'].options?.port)\n  ) {\n    e2ePort =\n      nxJson.targetDefaults?.['dev'].options?.port ??\n      nxJson.targetDefaults?.['serve'].options?.port;\n  }\n\n  return getE2EWebServerInfo(\n    tree,\n    projectName,\n    {\n      plugin: '@nx/vite/plugin',\n      serveTargetName: 'devTargetName',\n      serveStaticTargetName: 'previewTargetName',\n      configFilePath,\n    },\n    {\n      defaultServeTargetName: 'dev',\n      defaultServeStaticTargetName: 'preview',\n      defaultE2EWebServerAddress: `http://localhost:${e2ePort}`,\n      defaultE2ECiBaseUrl: 'http://localhost:4300',\n      defaultE2EPort: e2ePort,\n    },\n    isPluginBeingAdded\n  );\n}\n\nexport async function getReactRouterE2EWebServerInfo(\n  tree: Tree,\n  projectName: string,\n  configFilePath: string,\n  isPluginBeingAdded: boolean,\n  e2ePortOverride?: number\n) {\n  const e2ePort = e2ePortOverride ?? parseInt(process.env.PORT) ?? 4200;\n\n  return await getE2EWebServerInfo(\n    tree,\n    projectName,\n    {\n      plugin: '@nx/react/router-plugin',\n      serveTargetName: 'devTargetName',\n      serveStaticTargetName: 'devTargetName',\n      configFilePath,\n    },\n    {\n      defaultServeTargetName: 'dev',\n      defaultServeStaticTargetName: 'dev',\n      defaultE2EWebServerAddress: `http://localhost:${e2ePort}`,\n      defaultE2ECiBaseUrl: 'http://localhost:4200',\n      defaultE2EPort: e2ePort,\n    },\n    isPluginBeingAdded\n  );\n}\n"],"names":["getReactRouterE2EWebServerInfo","getViteE2EWebServerInfo","tree","projectName","configFilePath","isPluginBeingAdded","e2ePortOverride","nxJson","readNxJson","e2ePort","targetDefaults","options","port","getE2EWebServerInfo","plugin","serveTargetName","serveStaticTargetName","defaultServeTargetName","defaultServeStaticTargetName","defaultE2EWebServerAddress","defaultE2ECiBaseUrl","defaultE2EPort","parseInt","process","env","PORT"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;IA4CsBA,8BAA8B;eAA9BA;;IAzCAC,uBAAuB;eAAvBA;;;wBAHgB;uCACF;AAE7B,eAAeA,wBACpBC,IAAU,EACVC,WAAmB,EACnBC,cAAsB,EACtBC,kBAA2B,EAC3BC,eAAwB;QAMrBC,wBACCA,oCAAAA,yBACDA,yBACCA,sCAAAA;IAPJ,MAAMA,SAASC,IAAAA,kBAAU,EAACN;IAC1B,IAAIO,UAAUH,0BAAAA,kBAAmB;IAEjC,IACE,EAACC,yBAAAA,OAAOG,cAAc,qBAArBH,sBAAuB,CAAC,MAAM,OAC7BA,0BAAAA,OAAOG,cAAc,sBAArBH,qCAAAA,uBAAuB,CAAC,MAAM,CAACI,OAAO,qBAAtCJ,mCAAwCK,IAAI,KAC7CL,EAAAA,0BAAAA,OAAOG,cAAc,qBAArBH,uBAAuB,CAAC,QAAQ,OAC/BA,0BAAAA,OAAOG,cAAc,sBAArBH,uCAAAA,uBAAuB,CAAC,QAAQ,CAACI,OAAO,qBAAxCJ,qCAA0CK,IAAI,GAChD;YAEEL,qCAAAA,yBACAA,uCAAAA;YADAA;QADFE,UACEF,CAAAA,2CAAAA,0BAAAA,OAAOG,cAAc,sBAArBH,sCAAAA,uBAAuB,CAAC,MAAM,CAACI,OAAO,qBAAtCJ,oCAAwCK,IAAI,YAA5CL,2CACAA,0BAAAA,OAAOG,cAAc,sBAArBH,wCAAAA,uBAAuB,CAAC,QAAQ,CAACI,OAAO,qBAAxCJ,sCAA0CK,IAAI;IAClD;IAEA,OAAOC,IAAAA,0CAAmB,EACxBX,MACAC,aACA;QACEW,QAAQ;QACRC,iBAAiB;QACjBC,uBAAuB;QACvBZ;IACF,GACA;QACEa,wBAAwB;QACxBC,8BAA8B;QAC9BC,4BAA4B,CAAC,iBAAiB,EAAEV,QAAQ,CAAC;QACzDW,qBAAqB;QACrBC,gBAAgBZ;IAClB,GACAJ;AAEJ;AAEO,eAAeL,+BACpBE,IAAU,EACVC,WAAmB,EACnBC,cAAsB,EACtBC,kBAA2B,EAC3BC,eAAwB;QAERA;IAAhB,MAAMG,UAAUH,CAAAA,OAAAA,0BAAAA,kBAAmBgB,SAASC,QAAQC,GAAG,CAACC,IAAI,aAA5CnB,OAAiD;IAEjE,OAAO,MAAMO,IAAAA,0CAAmB,EAC9BX,MACAC,aACA;QACEW,QAAQ;QACRC,iBAAiB;QACjBC,uBAAuB;QACvBZ;IACF,GACA;QACEa,wBAAwB;QACxBC,8BAA8B;QAC9BC,4BAA4B,CAAC,iBAAiB,EAAEV,QAAQ,CAAC;QACzDW,qBAAqB;QACrBC,gBAAgBZ;IAClB,GACAJ;AAEJ"}